<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>XFootballHub - Mundial Penaltis 2022</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@600&display=swap');

  body {
    margin: 0;
    background: linear-gradient(135deg, #004d40, #1de9b6);
    font-family: 'Montserrat', sans-serif;
    color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    padding: 10px;
  }
  h1 {
    margin: 20px 0 10px;
    font-size: 2.8rem;
    letter-spacing: 4px;
    text-shadow: 0 2px 6px rgba(0,0,0,0.5);
  }
  #game-area {
    position: relative;
    width: 360px;
    height: 480px;
    background: url('https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&w=360&q=80') no-repeat center center/cover;
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.7);
    margin-bottom: 15px;
    user-select: none;
  }
  /* Portería 3x3 */
  #porteria {
    position: absolute;
    bottom: 60px;
    left: 50%;
    transform: translateX(-50%);
    width: 280px;
    height: 140px;
    background: #f0f0f0cc;
    border: 5px solid #004d40;
    border-radius: 12px;
    box-sizing: border-box;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(3, 1fr);
    gap: 2px;
  }
  /* Zonas transparent but clickable */
  .zona {
    background: rgba(29, 233, 182, 0.3);
    cursor: pointer;
    border-radius: 6px;
    transition: background-color 0.3s;
  }
  .zona:hover {
    background-color: rgba(29, 233, 182, 0.6);
  }
  /* Balón */
  #balon {
    position: absolute;
    width: 36px;
    height: 36px;
    background: url('https://upload.wikimedia.org/wikipedia/commons/e/e7/Soccer_ball_icon.svg') no-repeat center center / contain;
    top: 380px;
    left: 30px;
    transition: left 0.5s ease, top 0.5s ease;
    pointer-events: none;
    z-index: 5;
  }
  /* Jugador y portero humanos con partes */
  .personaje {
    position: absolute;
    width: 50px;
    height: 110px;
    display: flex;
    flex-direction: column;
    align-items: center;
    user-select: none;
  }
  /* Cabeza */
  .cabeza {
    width: 42px;
    height: 42px;
    background: var(--color-cuerpo);
    border-radius: 50%;
    border: 3px solid #222;
    box-shadow: 0 3px 8px rgba(0,0,0,0.5);
  }
  /* Cuerpo */
  .cuerpo {
    width: 32px;
    height: 50px;
    margin-top: 4px;
    background: var(--color-cuerpo);
    border-radius: 14px 14px 10px 10px;
    border: 3px solid #222;
    box-shadow: inset 0 5px 10px rgba(255,255,255,0.2);
    position: relative;
  }
  /* Brazos */
  .brazo-izq, .brazo-der {
    position: absolute;
    top: 6px;
    width: 12px;
    height: 38px;
    background: var(--color-cuerpo);
    border: 3px solid #222;
    border-radius: 8px;
  }
  .brazo-izq {
    left: -15px;
    transform: rotate(15deg);
    box-shadow: inset 0 3px 6px rgba(255,255,255,0.15);
  }
  .brazo-der {
    right: -15px;
    transform: rotate(-15deg);
    box-shadow: inset 0 3px 6px rgba(255,255,255,0.15);
  }
  /* Piernas */
  .piernas {
    width: 44px;
    height: 40px;
    margin-top: 4px;
    display: flex;
    justify-content: space-between;
  }
  .pierna {
    width: 16px;
    height: 38px;
    background: var(--color-piernas);
    border: 3px solid #222;
    border-radius: 8px;
    box-shadow: inset 0 4px 10px rgba(0,0,0,0.3);
  }

  /* Jugador usa variables CSS con color país */
  #jugador {
    --color-cuerpo: #4caf50;
    --color-piernas: #2e7d32;
    bottom: 20px;
    left: 20px;
    z-index: 10;
  }
  /* Portero neutro color azul */
  #portero {
    --color-cuerpo: #2196f3;
    --color-piernas: #1565c0;
    bottom: 200px;
    left: calc(50% - 25px);
    z-index: 10;
    transition: transform 0.5s ease;
  }

  /* Texto info */
  #info-partido {
    font-size: 1.1rem;
    margin-bottom: 10px;
    font-weight: 600;
    text-align: center;
    min-height: 28px;
  }
  #resultado {
    font-size: 1.4rem;
    font-weight: 700;
    text-align: center;
    height: 32px;
    margin-bottom: 15px;
    min-height: 32px;
  }
  #pantalla-titulo {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: #1de9b6cc;
    color: #004d40;
    font-weight: 700;
    font-size: 1.8rem;
    padding: 10px 20px;
    border-radius: 15px;
    box-shadow: 0 0 15px #1de9b6bb;
    display: none;
    z-index: 20;
  }
  #tabla-grupo {
    width: 100%;
    max-width: 360px;
    border-collapse: collapse;
    margin-bottom: 15px;
    user-select: none;
  }
  #tabla-grupo th, #tabla-grupo td {
    border: 1px solid #1de9b6;
    padding: 6px 8px;
    text-align: center;
    font-weight: 600;
    font-size: 0.9rem;
  }
  #tabla-grupo th {
    background: #004d40;
  }
  #tabla-grupo td {
    background: #00796bdd;
  }
  #next-partido-btn {
    background: #1de9b6;
    border: none;
    padding: 10px 30px;
    border-radius: 25px;
    font-weight: 700;
    font-size: 1.1rem;
    color: #004d40;
    cursor: pointer;
    transition: background-color 0.3s ease;
    user-select: none;
  }
  #next-partido-btn:disabled {
    background: #004d40aa;
    cursor: not-allowed;
  }

  /* Selector equipo inicial */
  #selector-equipo {
    margin-bottom: 20px;
    max-width: 360px;
    width: 100%;
  }
  #selector-equipo label {
    font-weight: 700;
    margin-right: 10px;
  }
  #selector-equipo select {
    padding: 6px 10px;
    font-weight: 600;
    border-radius: 8px;
    border: none;
    font-size: 1rem;
  }

  /* Responsive móvil */
  @media (max-width: 400px) {
    #game-area {
      width: 320px;
      height: 430px;
    }
    #tabla-grupo {
      max-width: 320px;
    }
    .personaje {
      width: 44px;
      height: 95px;
    }
    .cabeza {
      width: 36px;
      height: 36px;
    }
    .cuerpo {
      width: 28px;
      height: 44px;
    }
    .brazo-izq, .brazo-der {
      width: 10px;
      height: 34px;
    }
    .pierna {
      width: 14px;
      height: 34px;
    }
  }
</style>
</head>
<body>

<h1>Mundial Penaltis 2022</h1>

<div id="selector-equipo">
  <label for="equipo-select">Elige tu equipo:</label>
  <select id="equipo-select" aria-label="Selecciona equipo para jugar">
    <!-- Opciones cargadas dinámicamente -->
  </select>
  <button id="start-btn">Comenzar torneo</button>
</div>

<div id="info-partido" aria-live="polite"></div>
<div id="resultado" aria-live="assertive"></div>

<div id="game-area" aria-label="Área del juego de penaltis">
  <div id="portero" class="personaje" role="img" aria-label="Portero humano">
    <div class="cabeza"></div>
    <div class="cuerpo">
      <div class="brazo-izq"></div>
      <div class="brazo-der"></div>
    </div>
    <div class="piernas">
      <div class="pierna"></div>
      <div class="pierna"></div>
    </div>
  </div>

  <div id="jugador" class="personaje" role="img" aria-label="Delantero humano">
    <div class="cabeza"></div>
    <div class="cuerpo">
      <div class="brazo-izq"></div>
      <div class="brazo-der"></div>
    </div>
    <div class="piernas">
      <div class="pierna"></div>
      <div class="pierna"></div>
    </div>
  </div>

  <div id="balon" aria-hidden="true"></div>

  <div id="porteria" role="grid" aria-label="Portería dividida en nueve zonas">
    <!-- 9 zonas para disparo -->
  </div>
</div>

<table id="tabla-grupo" aria-label="Tabla de resultados de grupo" hidden>
  <thead>
    <tr>
      <th>Equipo</th>
      <th>PJ</th>
      <th>PG</th>
      <th>PE</th>
      <th>PP</th>
      <th>GF</th>
      <th>GC</th>
      <th>DG</th>
      <th>Puntos</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<button id="next-partido-btn" disabled>Partido siguiente</button>

<div id="pantalla-titulo" role="alert"></div>

<script>
  // Equipos con colores y banderas
  const equipos = [
    { nombre: "Qatar", codigo: "qat", color: "#7A003C", bandera: "https://flagcdn.com/w320/qa.png" },
    { nombre: "Ecuador", codigo: "ecu", color: "#FFDD00", bandera: "https://flagcdn.com/w320/ec.png" },
    { nombre: "Senegal", codigo: "sen", color: "#00853F", bandera: "https://flagcdn.com/w320/sn.png" },
    { nombre: "Países Bajos", codigo: "nld", color: "#FF6600", bandera: "https://flagcdn.com/w320/nl.png" },

    { nombre: "Inglaterra", codigo: "eng", color: "#CF142B", bandera: "https://flagcdn.com/w320/gb-eng.png" },
    { nombre: "Irán", codigo: "irn", color: "#239F40", bandera: "https://flagcdn.com/w320/ir.png" },
    { nombre: "Estados Unidos", codigo: "usa", color: "#B22234", bandera: "https://flagcdn.com/w320/us.png" },
    { nombre: "Gales", codigo: "wls", color: "#D72828", bandera: "https://flagcdn.com/w320/gb-wls.png" },

    { nombre: "Argentina", codigo: "arg", color: "#74ACDF", bandera: "https://flagcdn.com/w320/ar.png" },
    { nombre: "Arabia Saudí", codigo: "sau", color: "#006C35", bandera: "https://flagcdn.com/w320/sa.png" },
    { nombre: "México", codigo: "mex", color: "#006847", bandera: "https://flagcdn.com/w320/mx.png" },
    { nombre: "Polonia", codigo: "pol", color: "#DC143C", bandera: "https://flagcdn.com/w320/pl.png" },

    { nombre: "Francia", codigo: "fra", color: "#0055A4", bandera: "https://flagcdn.com/w320/fr.png" },
    { nombre: "Australia", codigo: "aus", color: "#FFD700", bandera: "https://flagcdn.com/w320/au.png" },
    { nombre: "Dinamarca", codigo: "dnk", color: "#C60C30", bandera: "https://flagcdn.com/w320/dk.png" },
    { nombre: "Túnez", codigo: "tun", color: "#E70013", bandera: "https://flagcdn.com/w320/tn.png" },

    { nombre: "España", codigo: "esp", color: "#C60B1E", bandera: "https://flagcdn.com/w320/es.png" },
    { nombre: "Costa Rica", codigo: "cri", color: "#D21034", bandera: "https://flagcdn.com/w320/cr.png" },
    { nombre: "Alemania", codigo: "deu", color: "#000000", bandera: "https://flagcdn.com/w320/de.png" },
    { nombre: "Japón", codigo: "jpn", color: "#BC002D", bandera: "https://flagcdn.com/w320/jp.png" },

    { nombre: "Bélgica", codigo: "bel", color: "#FF0000", bandera: "https://flagcdn.com/w320/be.png" },
    { nombre: "Canadá", codigo: "can", color: "#FF0000", bandera: "https://flagcdn.com/w320/ca.png" },
    { nombre: "Marruecos", codigo: "mar", color: "#006233", bandera: "https://flagcdn.com/w320/ma.png" },
    { nombre: "Croacia", codigo: "hrv", color: "#FF0000", bandera: "https://flagcdn.com/w320/hr.png" },

    { nombre: "Brasil", codigo: "bra", color: "#009B3A", bandera: "https://flagcdn.com/w320/br.png" },
    { nombre: "Serbia", codigo: "srb", color: "#D22B2B", bandera: "https://flagcdn.com/w320/rs.png" },
    { nombre: "Suiza", codigo: "che", color: "#FF0000", bandera: "https://flagcdn.com/w320/ch.png" },
    { nombre: "Camerún", codigo: "cmr", color: "#007A33", bandera: "https://flagcdn.com/w320/cm.png" },

    { nombre: "Portugal", codigo: "prt", color: "#FF0000", bandera: "https://flagcdn.com/w320/pt.png" },
    { nombre: "Ghana", codigo: "gha", color: "#FF0000", bandera: "https://flagcdn.com/w320/gh.png" },
    { nombre: "Uruguay", codigo: "ury", color: "#66CCFF", bandera: "https://flagcdn.com/w320/uy.png" },
    { nombre: "Corea del Sur", codigo: "kor", color: "#CD2E3A", bandera: "https://flagcdn.com/w320/kr.png" }
  ];

  // Grupos reales 2022
  const grupos2022 = {
    "A": ["Qatar", "Ecuador", "Senegal", "Países Bajos"],
    "B": ["Inglaterra", "Irán", "Estados Unidos", "Gales"],
    "C": ["Argentina", "Arabia Saudí", "México", "Polonia"],
    "D": ["Francia", "Australia", "Dinamarca", "Túnez"],
    "E": ["España", "Costa Rica", "Alemania", "Japón"],
    "F": ["Bélgica", "Canadá", "Marruecos", "Croacia"],
    "G": ["Brasil", "Serbia", "Suiza", "Camerún"],
    "H": ["Portugal", "Ghana", "Uruguay", "Corea del Sur"]
  };

  // Variables globales
  let grupoSeleccionado = null;
  let equipoUsuario = null;
  let faseActual = "grupos"; // grupos, octavos, cuartos, semifinales, final, terminado
  let grupos = {};
  let eliminatorias = {};
  let partidoActual = 0;
  let partidosFase = [];
  let puntosPorPartido = 3; // victoria
  let tirosPorPartido = 5;

  const equipoSelect = document.getElementById("equipo-select");
  const startBtn = document.getElementById("start-btn");
  const infoPartido = document.getElementById("info-partido");
  const resultadoEl = document.getElementById("resultado");
  const porteriaEl = document.getElementById("porteria");
  const balonEl = document.getElementById("balon");
  const jugadorEl = document.getElementById("jugador");
  const porteroEl = document.getElementById("portero");
  const tablaGrupoEl = document.getElementById("tabla-grupo");
  const tablaCuerpo = tablaGrupoEl.querySelector("tbody");
  const nextPartidoBtn = document.getElementById("next-partido-btn");
  const pantallaTituloEl = document.getElementById("pantalla-titulo");

  // Carga equipos en el selector
  function cargarSelectorEquipos() {
    equipoSelect.innerHTML = `<option value="">-- Selecciona equipo --</option>`;
    equipos.forEach(e => {
      equipoSelect.innerHTML += `<option value="${e.nombre}">${e.nombre}</option>`;
    });
  }

  // Obtener equipo por nombre
  function obtenerEquipo(nombre) {
    return equipos.find(e => e.nombre === nombre);
  }

  // Crear zonas 3x3 en portería
  function crearZonas() {
    porteriaEl.innerHTML = "";
    for(let i=0; i<9; i++) {
      const div = document.createElement("div");
      div.classList.add("zona");
      div.setAttribute("data-index", i);
      div.setAttribute("role", "button");
      div.setAttribute("tabindex", "0");
      porteriaEl.appendChild(div);
    }
  }

  // Inicializar grupo con datos iniciales
  function inicializarGrupos() {
    grupos = {};
    for(const letra in grupos2022) {
      grupos[letra] = grupos2022[letra].map(nombre => ({
        nombre,
        ...obtenerEquipo(nombre),
        pj: 0, pg:0, pe:0, pp:0, gf:0, gc:0, dg:0, puntos:0
      }));
    }
  }

  // Mostrar tabla grupo para el equipo usuario
  function mostrarTablaGrupo() {
    tablaGrupoEl.hidden = false;
    tablaCuerpo.innerHTML = "";
    // Mostrar sólo el grupo del equipo usuario para simplicidad
    if(!equipoUsuario) return;
    let grupo = null;
    for(const letra in grupos) {
      if(grupos[letra].some(e => e.nombre === equipoUsuario.nombre)) {
        grupo = grupos[letra];
        break;
      }
    }
    grupo.forEach(e => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${e.nombre}</td>
        <td>${e.pj}</td>
        <td>${e.pg}</td>
        <td>${e.pe}</td>
        <td>${e.pp}</td>
        <td>${e.gf}</td>
        <td>${e.gc}</td>
        <td>${e.dg}</td>
        <td>${e.puntos}</td>
      `;
      tr.style.color = e.color;
      tablaCuerpo.appendChild(tr);
    });
  }

  // Simula resultado de penalti (gol o parada)
  // dificultad: 1-3, mayor es más difícil parar
  function tirarPenalti(zonaElegida, dificultad){
    // Portero elige zona aleatoria, con probabilidad de acertar mayor en dificultad alta
    const zonasPortero = [0,1,2,3,4,5,6,7,8];
    let zonaPortero;
    if(dificultad === 1) zonaPortero = zonasPortero[Math.floor(Math.random()*zonasPortero.length)];
    else if(dificultad === 2) zonaPortero = zonasPortero[Math.floor(Math.random()*zonasPortero.length)];
    else zonaPortero = zonasPortero[Math.floor(Math.random()*zonasPortero.length)];

    // Ajustar probabilidad: Si portero acierta zona, paro 60% chance, si no, gol 90%
    let gol;
    if(zonaElegida === zonaPortero){
      gol = Math.random() > 0.6 ? true : false; // 40% gol
    } else {
      gol = Math.random() > 0.1 ? true : false; // 90% gol
    }
    return { gol, zonaPortero };
  }

  // Animación balon hacia zona
  function moverBalonHaciaZona(index) {
    // Zonas 3x3 tienen posiciones relativas
    // Vamos a posicionar balon en el centro de la zona
    const zona = porteriaEl.querySelector(`.zona[data-index="${index}"]`);
    if(!zona) return;

    const rectPorteria = porteriaEl.getBoundingClientRect();
    const rectZona = zona.getBoundingClientRect();

    // Calcular posición relativa dentro del game area
    const gameAreaRect = document.getElementById("game-area").getBoundingClientRect();

    // Posición balon centrado en zona
    const balonX = rectZona.left - gameAreaRect.left + rectZona.width/2 - balonEl.offsetWidth/2;
    const balonY = rectZona.top - gameAreaRect.top + rectZona.height/2 - balonEl.offsetHeight/2;

    balonEl.style.left = balonX + "px";
    balonEl.style.top = balonY + "px";
  }

  // Animar portero a zona de parada
  function moverPorteroAZona(index) {
    // Las zonas 3x3 están organizadas así:
    // 0 1 2
    // 3 4 5
    // 6 7 8
    // Portero se moverá horizontal y verticalmente un poco según zona elegida

    const baseX = (window.innerWidth > 400) ? 180 : 160;
    const baseY = 280;
    const gridCol = index % 3;
    const gridRow = Math.floor(index / 3);

    const offsetX = (gridCol - 1) * 60; // -60, 0, +60
    const offsetY = (gridRow - 1) * 25; // -25,0,+25

    porteroEl.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
  }

  // Reset posiciones para siguiente tiro
  function resetPosiciones() {
    balonEl.style.left = "30px";
    balonEl.style.top = "380px";
    porteroEl.style.transform = "translate(0,0)";
  }

  // Actualizar color jugador según equipo
  function actualizarColorJugador() {
    if(!equipoUsuario) return;
    jugadorEl.style.setProperty("--color-cuerpo", equipoUsuario.color);
    // Piernas un poco más oscuro
    let c = equipoUsuario.color;
    // simplificar a negro para contraste si negro
    if(c.toLowerCase() === "#000000") jugadorEl.style.setProperty("--color-piernas", "#222");
    else jugadorEl.style.setProperty("--color-piernas", shadeColor(c, -30));
  }

  // Función para oscurecer color (para piernas)
  function shadeColor(color, percent) {
    let f=parseInt(color.slice(1),16),t=percent<0?0:255,p=percent<0?percent*-1:percent;
    let R=f>>16,G=f>>8&0x00FF,B=f&0x0000FF;
    return "#" + (0x1000000 + (Math.round((t - R) * p / 100) + R)*0x10000 + (Math.round((t - G) * p / 100) + G)*0x100 + (Math.round((t - B) * p / 100) + B)).toString(16).slice(1);
  }

  // Inicializar juego y eventos
  function inicializarJuego() {
    crearZonas();
    inicializarGrupos();
    mostrarTablaGrupo();
    resetPosiciones();
    actualizarColorJugador();

    // Eventos zona click para tirar
    porteriaEl.querySelectorAll(".zona").forEach(zona => {
      zona.onclick = () => {
        if(faseActual !== "grupos" && faseActual !== "eliminatorias") return;
        if(partidosFase[partidoActual].turno === "penalti") {
          tirarAPorteria(parseInt(zona.dataset.index));
        }
      };
      zona.onkeydown = e => {
        if((e.key === "Enter" || e.key === " ") && faseActual !== "terminado") {
          zona.click();
          e.preventDefault();
        }
      };
    });

    nextPartidoBtn.onclick = () => {
      siguientePartido();
    };
  }

  // Tirar al penalti
  function tirarAPorteria(zonaElegida) {
    nextPartidoBtn.disabled = true;
    infoPartido.textContent = `¡Disparando a zona ${zonaElegida + 1}!`;

    moverBalonHaciaZona(zonaElegida);

    // Simulación corto delay
    setTimeout(() => {
      const dificultad = 2;
      const resultado = tirarPenalti(zonaElegida, dificultad);
      moverPorteroAZona(resultado.zonaPortero);

      if(resultado.gol) {
        infoPartido.textContent = "¡Gol!";
        resultadoEl.textContent = "⚽️";
        actualizarMarcador(true);
      } else {
        infoPartido.textContent = "¡Parada del portero!";
        resultadoEl.textContent = "🧤";
        actualizarMarcador(false);
      }

      // Tras un segundo permitir siguiente tiro o fase
      setTimeout(() => {
        nextPartidoBtn.disabled = false;
        partidoActual++;
        if(partidoActual >= partidosFase.length) {
          terminarFase();
        } else {
          infoPartido.textContent = `Tiro ${partidoActual+1} de ${partidosFase.length}`;
          resetPosiciones();
        }
      }, 1000);
    }, 700);
  }

  // Variables marcador
  let golesUsuario = 0;
  let golesRival = 0;

  // Actualiza marcador según resultado
  function actualizarMarcador(gol) {
    if(gol) golesUsuario++;
    else golesRival++;
  }

  // Siguiente partido / tiro
  function siguientePartido() {
    if(faseActual === "terminado") {
      alert("El torneo terminó. Recarga para jugar otra vez.");
      return;
    }
    if(partidoActual >= partidosFase.length) {
      terminarFase();
      return;
    }
    infoPartido.textContent = `Tiro ${partidoActual+1} de ${partidosFase.length}`;
    resultadoEl.textContent = "";
    nextPartidoBtn.disabled = true;
  }

  // Terminar fase, mostrar resultado, avanzar
  function terminarFase() {
    // Ejemplo simple: si gana usuario, pasa siguiente ronda
    if(golesUsuario > golesRival) {
      infoPartido.textContent = `¡${equipoUsuario.nombre} pasa a la siguiente ronda! (${golesUsuario} - ${golesRival})`;
      pantallaTitulo(`¡${equipoUsuario.nombre} avanza!`);
      faseActual = "eliminatorias";
      prepararEliminatorias();
    } else if(golesUsuario < golesRival) {
      infoPartido.textContent = `¡${equipoUsuario.nombre} queda eliminado! (${golesUsuario} - ${golesRival})`;
      pantallaTitulo(`¡Fin del torneo!`);
      faseActual = "terminado";
      nextPartidoBtn.disabled = true;
    } else {
      infoPartido.textContent = `Empate (${golesUsuario} - ${golesRival}), ¡se repite!`;
      pantallaTitulo(`Empate, tira otra vez`);
      partidoActual = 0;
      golesUsuario = 0;
      golesRival = 0;
      resetPosiciones();
      nextPartidoBtn.disabled = true;
    }
  }

  // Pantalla título animada
  function pantallaTitulo(texto) {
    pantallaTituloEl.textContent = texto;
    pantallaTituloEl.style.display = "block";
    setTimeout(() => {
      pantallaTituloEl.style.display = "none";
    }, 2500);
  }

  // Prepara eliminatorias (ejemplo simple con usuario vs rival random)
  function prepararEliminatorias() {
    // Rival random distinto del usuario
    const rivalesPosibles = equipos.filter(e => e.nombre !== equipoUsuario.nombre);
    const rival = rivalesPosibles[Math.floor(Math.random() * rivalesPosibles.length)];

    partidosFase = [
      { equipo1: equipoUsuario, equipo2: rival, turno: "penalti" }
    ];
    partidoActual = 0;
    golesUsuario = 0;
    golesRival = 0;

    infoPartido.textContent = `Octavos: ${equipoUsuario.nombre} vs ${rival.nombre}. Elige zona para disparar`;
    resultadoEl.textContent = "";
    mostrarTablaGrupo();
    nextPartidoBtn.disabled = false;
  }

  // Arrancar torneo tras seleccionar equipo
  function comenzarTorneo() {
    const nombreEquipo = equipoSelect.value;
    if(!nombreEquipo) {
      alert("Selecciona un equipo primero");
      return;
    }
    equipoUsuario = obtenerEquipo(nombreEquipo);
    pantallaTitulo(`Has elegido: ${equipoUsuario.nombre}`);
    faseActual = "grupos";
    inicializarGrupos();
    mostrarTablaGrupo();
    partidoActual = 0;
    golesUsuario = 0;
    golesRival = 0;

    // Preparar partidos fase grupos (ejemplo solo usuario vs primer rival)
    const grupoLetra = Object.keys(grupos).find(g => grupos[g].some(e => e.nombre === equipoUsuario.nombre));
    const grupoEquipos = grupos[grupoLetra];
    const rival = grupoEquipos.find(e => e.nombre !== equipoUsuario.nombre);

    partidosFase = [];
    for(let i=0; i<tirosPorPartido; i++){
      partidosFase.push({ equipo1: equipoUsuario, equipo2: rival, turno: "penalti" });
    }

    infoPartido.textContent = `Fase de grupos: ${equipoUsuario.nombre} vs ${rival.nombre}. Elige zona para disparar`;
    resultadoEl.textContent = "";
    nextPartidoBtn.disabled = true;
  }

  // Eventos
  startBtn.onclick = () => {
    comenzarTorneo();
  };

  cargarSelectorEquipos();
  inicializarJuego();
})();  
</script>

</body>
</html>
